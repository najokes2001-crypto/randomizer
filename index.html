<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞–Ω–¥–æ–º–∞–π–∑–µ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω–∫—É—Ä—Å–∞</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            font-size: 18px;
            overflow-x: hidden;
        }
        
        .main {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            width: 100%;
            max-width: 1200px;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            color: #e91e63;
            margin-bottom: 20px;
            font-size: 42px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #555;
            margin: 20px 0;
            font-size: 28px;
        }
        
        h3 {
            font-size: 22px;
            color: #777;
            margin: 15px 0;
        }
        
        .form-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: left;
            border-left: 5px solid #e91e63;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 20px;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #e91e63;
            outline: none;
            box-shadow: 0 0 10px rgba(233,30,99,0.3);
        }
        
        .my_button {
            background: linear-gradient(45deg, #e91e63, #ff4081);
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 20px 0;
            border-radius: 20px;
            font-size: 22px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-block;
        }
        
        .my_button:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(233,30,99,0.4);
        }
        
        .my_button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .secondary_button {
            background: linear-gradient(45deg, #2196f3, #21cbf3);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            border-radius: 15px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-block;
        }
        
        .secondary_button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(33,150,243,0.4);
        }
        
        .results-container {
            display: none;
            margin-top: 30px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .participants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .participant-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border: 3px solid #ffeb3b;
            position: relative;
        }
        
        .participant-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.2);
        }
        
        .participant-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            border-bottom: 3px solid #ffeb3b;
        }
        
        .participant-info {
            padding: 15px;
        }
        
        .participant-name {
            font-size: 22px;
            font-weight: bold;
            color: #e91e63;
            margin-bottom: 8px;
        }
        
        .participant-status {
            font-size: 18px;
            color: #555;
            margin-bottom: 5px;
        }
        
        .participant-times {
            font-size: 16px;
            color: #888;
            font-style: italic;
        }
        
        .spinner {
            width: 70px;
            height: 70px;
            border: 7px solid #f3f3f3;
            border-top: 7px solid #e91e63;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 30px auto;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #f00;
            opacity: 0.8;
            border-radius: 0;
            animation: confettiFall 5s linear forwards;
            z-index: 100;
        }
        
        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(1000px) rotate(720deg); opacity: 0; }
        }
        
        .error-message {
            color: #f44336;
            font-size: 18px;
            margin-top: 10px;
            display: none;
        }
        
        .stats-container {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .stats-item {
            display: inline-block;
            margin: 0 15px;
            font-size: 18px;
            color: #555;
        }
        
        .stats-value {
            font-weight: bold;
            color: #e91e63;
        }
        
        .reset-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff5722;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            .participants-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            h1 {
                font-size: 32px;
            }
            
            h2 {
                font-size: 24px;
            }
            
            .my_button {
                font-size: 20px;
                padding: 12px 25px;
            }
            
            .stats-item {
                display: block;
                margin: 10px 0;
            }
        }
        
        @media (max-width: 480px) {
            .main {
                padding: 20px;
            }
            
            .participants-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 28px;
            }
            
            .form-container {
                padding: 15px;
            }
            
            label, input, select {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class='main'>
        <h1>üé≤ –†–∞–Ω–¥–æ–º–∞–π–∑–µ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω–∫—É—Ä—Å–∞ üé≤</h1>
        
        <div class="stats-container">
            <div class="stats-item">–í—Å–µ–≥–æ –≥–æ—Å—Ç–µ–π: <span class="stats-value" id="total-guests">36</span></div>
            <div class="stats-item">–£–∂–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª–∏: <span class="stats-value" id="participated-guests">0</span></div>
            <div class="stats-item">–û—Å—Ç–∞–ª–æ—Å—å: <span class="stats-value" id="remaining-guests">36</span></div>
        </div>
        
        <div class="form-container">
            <div class="form-group">
                <label for="participants-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</label>
                <input type="number" id="participants-count" min="1" max="36" value="5">
            </div>
            
            <div class="form-group">
                <label for="gender-filter">–ü–æ–ª —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</label>
                <select id="gender-filter">
                    <option value="any">–ë–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã</option>
                    <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                    <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="side-filter">–°—Ç–æ—Ä–æ–Ω–∞:</label>
                <select id="side-filter">
                    <option value="any">–ë–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã</option>
                    <option value="bride">–°—Ç–æ—Ä–æ–Ω–∞ –Ω–µ–≤–µ—Å—Ç—ã</option>
                    <option value="groom">–°—Ç–æ—Ä–æ–Ω–∞ –∂–µ–Ω–∏—Ö–∞</option>
                </select>
            </div>
        </div>
        
        <button class="my_button" onclick="startRandomization()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–±–æ—Ä!</button>
        <button class="secondary_button" onclick="resetSelection()">–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
        
        <div class="spinner" id="spinner"></div>
        <div class="error-message" id="error-message"></div>
        
        <div class="results-container" id="results-container">
            <h2>–í—ã–±—Ä–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:</h2>
            <h3 id="round-info">–ü–µ—Ä–≤—ã–π –∫—Ä—É–≥ —É—á–∞—Å—Ç–∏—è</h3>
            <div class="participants-grid" id="participants-grid">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ -->
            </div>
        </div>
    </div>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –æ –≥–æ—Å—Ç—è—Ö
        var guestNames = [
            "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–î–º–∏—Ç—Ä–∏–π", "–ù–∞—Ç–∞–ª—å—è", "–ì—Ä–∏–≥–æ—Ä–∏–π", "–í–∏–∫—Ç–æ—Ä",
            "–ê–ª–µ–∫—Å–µ–π", "–û–ª—å–≥–∞", "–ù–∞—Ç–∞–ª—å—è", "–û–ª—å–≥–∞", "–†–æ–º–∞–Ω",
            "–õ–∏–ª–∏—è", "–î–∞–Ω–∏–∏–ª", "–ò–ª—å—è", "–ù–∞—Ç–∞–ª—å—è", "–î–∞–Ω–∏–∏–ª",
            "–ê–Ω—Ç–æ–Ω–∏–Ω–∞", "–î–º–∏—Ç—Ä–∏–π", "–ê–ª–µ–Ω–∞", "–ò–ª—å—è", "–î–º–∏—Ç—Ä–∏–π",
            "–ú–∞—Ä–∏—è", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–í–ª–∞–¥", "–õ—é–±–æ–≤—å", "–õ—é–±–æ–≤—å",
            "–†–æ–º–∞–Ω", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ê–Ω–Ω–∞",
            "–Ø—Ä–æ—Å–ª–∞–≤", "–ò–≤–∞–Ω", "–ò–ª—å—è", "–õ—é–±–æ–≤—å", "–ú–∞—Ä–∏–Ω–∞", "–≠–¥–≥–∞—Ä"
        ];

        var guestStatuses = [
            "–ù–µ–≤–µ—Å—Ç–∞ üë∞", "–ñ–µ–Ω–∏—Ö ü§µ", "–ú–∞–º–∞ –Ω–µ–≤–µ—Å—Ç—ã üë©", "–ü–∞–ø–∞ –Ω–µ–≤–µ—Å—Ç—ã üë®", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶",
            "–ü–∞–ø–∞ –∂–µ–Ω–∏—Ö–∞ üë®", "–ú–∞—á–µ—Ö–∞ –∂–µ–Ω–∏—Ö–∞ üë©", "–ë–∞–±—É—à–∫–∞ –∂–µ–Ω–∏—Ö–∞ üëµ", "–ë–∞–±—É—à–∫–∞ –Ω–µ–≤–µ—Å—Ç—ã üëµ", "–ë—Ä–∞—Ç –∂–µ–Ω–∏—Ö–∞ üë¶",
            "–°–µ—Å—Ç—Ä–∞ –∂–µ–Ω–∏—Ö–∞ üëß", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶", "–î—è–¥—è –Ω–µ–≤–µ—Å—Ç—ã üë®", "–ö—Ä–µ—Å—Ç–Ω–∞—è/—Ç–µ—Ç—è –Ω–µ–≤–µ—Å—Ç—ã üë©", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ",
            "–í—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∫–∞ –¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíë", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíÉ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ",
            "–ü–æ–¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ",
            "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ",
            "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–°–≤–æ–¥–Ω–∞—è —Å–µ—Å—Ç—Ä–∞ üëß", "–¢–µ—Ç—è –Ω–µ–≤–µ—Å—Ç—ã üë©", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶"
        ];

        // –ú–∞—Å—Å–∏–≤ —Å –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
        var images = [];
        for (var i = 2; i <= 36; i++) {
            images.push("1 (" + i + ").jpg");
        }
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Å—Ç—è
        var guestGenders = [
            "female", "male", "female", "male", "male",
            "male", "female", "female", "female", "male",
            "female", "male", "male", "female", "male",
            "female", "male", "female", "male", "male",
            "female", "female", "male", "female", "female",
            "male", "female", "female", "female", "female",
            "male", "male", "male", "female", "female", "male"
        ];
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–æ—Ä–æ–Ω—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Å—Ç—è
        var guestSides = [
            "bride", "groom", "bride", "bride", "bride",
            "groom", "groom", "groom", "bride", "groom",
            "groom", "bride", "bride", "bride", "groom",
            "groom", "groom", "groom", "groom", "groom",
            "groom", "bride", "groom", "bride", "bride",
            "bride", "bride", "bride", "bride", "bride",
            "bride", "groom", "bride", "bride", "bride", "bride"
        ];
        
        // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–∏–π –∫–∞–∂–¥–æ–≥–æ –≥–æ—Å—Ç—è
        var participationCount = new Array(guestNames.length).fill(0);
        
        // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≥–æ—Å—Ç–µ–π –≤ —Ç–µ–∫—É—â–µ–º –∫—Ä—É–≥–µ
        var selectedInCurrentRound = [];
        
        // –¢–µ–∫—É—â–∏–π –∫—Ä—É–≥ (1 - –ø–µ—Ä–≤—ã–π –∫—Ä—É–≥, 2 - –≤—Ç–æ—Ä–æ–π –∏ —Ç.–¥.)
        var currentRound = 1;
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            var total = guestNames.length;
            var participated = participationCount.filter(count => count > 0).length;
            var remaining = total - participated;
            
            $("#total-guests").text(total);
            $("#participated-guests").text(participated);
            $("#remaining-guests").text(remaining);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—Ä—É–≥–µ
            var roundText = "–ü–µ—Ä–≤—ã–π –∫—Ä—É–≥ —É—á–∞—Å—Ç–∏—è";
            if (currentRound === 2) {
                roundText = "–í—Ç–æ—Ä–æ–π –∫—Ä—É–≥ —É—á–∞—Å—Ç–∏—è";
            } else if (currentRound === 3) {
                roundText = "–¢—Ä–µ—Ç–∏–π –∫—Ä—É–≥ —É—á–∞—Å—Ç–∏—è";
            } else if (currentRound > 3) {
                roundText = currentRound + "-–π –∫—Ä—É–≥ —É—á–∞—Å—Ç–∏—è";
            }
            $("#round-info").text(roundText);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏
        function startRandomization() {
            // –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ—à–∏–±–∫–∏
            $("#results-container").hide();
            $("#error-message").hide();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
            $("#spinner").show();
            
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
            var count = parseInt($("#participants-count").val());
            var genderFilter = $("#gender-filter").val();
            var sideFilter = $("#side-filter").val();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞
            if (isNaN(count) || count < 1 || count > 36) {
                showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 36");
                $("#spinner").hide();
                return;
            }
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(function() {
                // –§–∏–ª—å—Ç—Ä—É–µ–º –≥–æ—Å—Ç–µ–π –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
                var availableGuests = getAvailableGuests(genderFilter, sideFilter);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –≥–æ—Å—Ç–µ–π –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
                if (availableGuests.length < count) {
                    showError("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–æ—Å—Ç–µ–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –î–æ—Å—Ç—É–ø–Ω–æ: " + availableGuests.length);
                    $("#spinner").hide();
                    return;
                }
                
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                var selectedGuests = selectRandomGuests(availableGuests, count);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —É—á–∞—Å—Ç–∏–π
                selectedGuests.forEach(function(guestIndex) {
                    participationCount[guestIndex]++;
                    selectedInCurrentRound.push(guestIndex);
                });
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                displayResults(selectedGuests);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateStats();
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                $("#spinner").hide();
                $("#results-container").show();
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
                createConfetti();
            }, 1500);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–æ—Å—Ç–µ–π —Å —É—á–µ—Ç–æ–º –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
        function getAvailableGuests(genderFilter, sideFilter) {
            var available = [];
            
            // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –≥–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ —Ç–µ–∫—É—â–µ–º –∫—Ä—É–≥–µ
            for (var i = 0; i < guestNames.length; i++) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –ª–∏ –≥–æ—Å—Ç—å –≤ —Ç–µ–∫—É—â–µ–º –∫—Ä—É–≥–µ
                if (selectedInCurrentRound.includes(i)) continue;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—É
                var genderMatch = (genderFilter === "any" || guestGenders[i] === genderFilter);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–æ—Ä–æ–Ω–µ
                var sideMatch = (sideFilter === "any" || guestSides[i] === sideFilter);
                
                // –ï—Å–ª–∏ –æ–±–∞ –∫—Ä–∏—Ç–µ—Ä–∏—è —Å–æ–≤–ø–∞–¥–∞—é—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –≥–æ—Å—Ç—è –≤ –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å–ø–∏—Å–æ–∫
                if (genderMatch && sideMatch) {
                    available.push(i);
                }
            }
            
            // –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–æ—Å—Ç–µ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π –∫—Ä—É–≥
            if (available.length === 0) {
                currentRound++;
                selectedInCurrentRound = [];
                
                // –ü–æ–≤—Ç–æ—Ä—è–µ–º –ø–æ–∏—Å–∫ —Å –æ—á–∏—â–µ–Ω–Ω—ã–º —Å–ø–∏—Å–∫–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –∫—Ä—É–≥–∞
                for (var i = 0; i < guestNames.length; i++) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—É
                    var genderMatch = (genderFilter === "any" || guestGenders[i] === genderFilter);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–æ—Ä–æ–Ω–µ
                    var sideMatch = (sideFilter === "any" || guestSides[i] === sideFilter);
                    
                    // –ï—Å–ª–∏ –æ–±–∞ –∫—Ä–∏—Ç–µ—Ä–∏—è —Å–æ–≤–ø–∞–¥–∞—é—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –≥–æ—Å—Ç—è –≤ –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å–ø–∏—Å–æ–∫
                    if (genderMatch && sideMatch) {
                        available.push(i);
                    }
                }
            }
            
            return available;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –≥–æ—Å—Ç–µ–π
        function selectRandomGuests(availableIndexes, count) {
            // –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –º–∞—Å—Å–∏–≤–∞, —á—Ç–æ–±—ã –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª
            var available = [...availableIndexes];
            var selected = [];
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã—Ö –≥–æ—Å—Ç–µ–π
            for (var i = 0; i < count; i++) {
                if (available.length === 0) break;
                
                var randomIndex = Math.floor(Math.random() * available.length);
                var guestIndex = available[randomIndex];
                
                selected.push(guestIndex);
                
                // –£–¥–∞–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Å—Ç—è –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
                available.splice(randomIndex, 1);
            }
            
            return selected;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(selectedGuests) {
            var grid = $("#participants-grid");
            grid.empty();
            
            selectedGuests.forEach(function(guestIndex) {
                var card = $('<div class="participant-card"></div>');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –±–µ–π–¥–∂ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—á–∞—Å—Ç–∏–π, –µ—Å–ª–∏ –±–æ–ª—å—à–µ 1
                if (participationCount[guestIndex] > 1) {
                    card.append('<div class="reset-badge">' + participationCount[guestIndex] + '</div>');
                }
                
                // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                var img = new Image();
                img.className = "participant-image";
                img.alt = guestNames[guestIndex];
                img.onerror = function() {
                    this.src = "https://via.placeholder.com/280x220/ffeb3b/000?text=–§–æ—Ç–æ+–Ω–µ+–Ω–∞–π–¥–µ–Ω–æ";
                };
                img.src = images[guestIndex];
                
                // –°–æ–∑–¥–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–µ
                var info = $('<div class="participant-info"></div>');
                info.append('<div class="participant-name">' + guestNames[guestIndex] + '</div>');
                info.append('<div class="participant-status">' + guestStatuses[guestIndex] + '</div>');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É—á–∞—Å—Ç–∏–π
                var timesText = "–£—á–∞—Å—Ç–≤—É–µ—Ç –≤–ø–µ—Ä–≤—ã–µ";
                if (participationCount[guestIndex] > 1) {
                    timesText = "–£—á–∞—Å—Ç–≤—É–µ—Ç " + participationCount[guestIndex] + " —Ä–∞–∑";
                }
                info.append('<div class="participant-times">' + timesText + '</div>');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∫–∞—Ä—Ç–æ—á–∫—É
                card.append(img);
                card.append(info);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –≤ —Å–µ—Ç–∫—É
                grid.append(card);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        function createConfetti() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            const container = $('.main');
            
            for (let i = 0; i < 30; i++) {
                const confetti = $('<div class="confetti"></div>');
                confetti.css({
                    left: Math.random() * 100 + '%',
                    background: colors[Math.floor(Math.random() * colors.length)],
                    transform: 'rotate(' + (Math.random() * 360) + 'deg)'
                });
                
                container.append(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–∫–∏
        function showError(message) {
            $("#error-message").text(message).show();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –≤—ã–±–æ—Ä–∞
        function resetSelection() {
            participationCount = new Array(guestNames.length).fill(0);
            selectedInCurrentRound = [];
            currentRound = 1;
            updateStats();
            $("#results-container").hide();
            alert("–í—ã–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–±—Ä–æ—à–µ–Ω! –í—Å–µ –≥–æ—Å—Ç–∏ —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—ã–±–æ—Ä–∞.");
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        $(document).ready(function() {
            updateStats();
        });
    </script>
</body>
</html>
